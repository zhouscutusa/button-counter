<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>按钮计数器 · ✅/❌ 可视化</title>
<style>
  :root { --gap: 10px; --btn-size: 56px; --radius: 12px; }
  body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, "PingFang SC", "Noto Sans CJK SC", "Microsoft YaHei", sans-serif; 
         margin: 0; padding: 16px; background:#0b0c10; color:#eef2f7; }
  h1 { font-size: 20px; margin: 0 0 12px; }
  .wrap { display:grid; gap: var(--gap); grid-template-columns: 1fr; max-width:880px; margin:0 auto; }
  @media (min-width: 820px) {
    .wrap { grid-template-columns: 1.2fr 1fr; align-items: start; }
  }

  .card { background:#151823; border:1px solid #252a36; border-radius: 14px; padding: 14px; }
  .row { display:flex; gap:var(--gap); align-items:center; flex-wrap:wrap; }
  .grid {
    display:grid; gap: var(--gap);
    grid-template-columns: repeat(3, minmax(0, 1fr));
  }
  @media (max-width: 480px) {
    .grid { grid-template-columns: repeat(3, minmax(0, 1fr)); }
  }

  button.num {
    height: var(--btn-size);
    border-radius: var(--radius);
    border: 1px solid #2a3143;
    background: linear-gradient(180deg,#1b2131,#121726);
    color:#e8eef7; font-size:18px; font-weight:600;
    cursor:pointer; position:relative;
    transition: transform .05s ease, border-color .15s ease, background .15s ease;
    -webkit-tap-highlight-color: transparent;
  }
  button.num:active { transform: translateY(1px) scale(0.98); }
  button.num:hover { border-color:#3a465f; }
  button.num .badge {
    position:absolute; top:-6px; right:-6px; min-width:24px; height:24px;
    border-radius: 999px; background:#2a8852; color:white;
    display:flex; align-items:center; justify-content:center;
    padding:0 6px; font-size:12px; font-weight:700; border:1px solid #133e29;
  }
  button.num.zero .badge { background:#6b7280; border-color:#2e3137; } /* 0 次时灰色 */

  .toolbar { display:flex; gap:var(--gap); flex-wrap:wrap; margin-bottom: 8px; }
  .btn {
    height: 40px; padding: 0 14px; border-radius: 10px; border:1px solid #2a3143;
    background:#121726; color:#e8eef7; cursor:pointer; font-weight:600;
  }
  .btn:hover { border-color:#3a465f; }
  .btn--danger { background:#2a171a; border-color:#552328; color:#ffdee2; }
  .btn--danger:hover { border-color:#7a3239; }

  .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; }
  .list { line-height: 1.7; font-size: 15px; white-space: pre-wrap; }
  .muted { color:#aab3c2; font-size:13px; }
  .pill {
    display:inline-block; padding:2px 8px; border-radius:999px; border:1px solid #2a3143;
    background:#0f1424; margin:2px 6px 2px 0; font-size:13px;
  }
</style>
</head>
<body>
  <div class="wrap">
    <section class="card">
      <h1>请选择（点一下=+1）</h1>
<div class="toolbar" style="align-items:center;">
  <!-- 范围输入框 -->
  <input
    id="rangeStart"
    type="text"
    maxlength="3"
    placeholder=""
    style="font-size:20px;text-align:center;width:70px;border-radius:8px;
           border:2px solid #2a3143;background:#0f1424;color:#e8eef7;outline:none;"
  >
  <span style="font-size:20px;margin:0 4px;">-</span>
  <input
    id="rangeEnd"
    type="text"
    maxlength="3"
    placeholder=""
    style="font-size:20px;text-align:center;width:70px;border-radius:8px;
           border:2px solid #2a3143;background:#0f1424;color:#e8eef7;outline:none;"
  >

  <!-- 清空与下一批按钮 -->
  <button id="resetBtn" class="btn btn--danger" style="margin-left:8px;">清空</button>
  <button id="nextBtn" class="btn" style="margin-left:6px;">下一批</button>

  <span class="muted">提示：点按钮会累计次数；次数徽章在按钮右上角。</span>
</div>
      <div id="btnGrid" class="grid"></div>
      <!-- 新增的大数字输入框 -->
      <div style="margin-top:20px; text-align:center;">
        <input
          id="bigNumber"
          type="text"
          maxlength="3"
          value="000"
          style="font-size:48px; text-align:center; width:150px; border-radius:10px;
                 border:2px solid #2a3143; background:#0f1424; color:#e8eef7; outline:none;"
        >
      </div>
    </section>

    <section class="card">
      <h1>结果</h1>
      <div class="row">
        <div><span class="pill">✅ = 点过的次数（重复显示）</span><span class="pill">❌ = 从未点击</span></div>
      </div>
      <h3 class="muted" style="margin:10px 0 4px;">可视化计数</h3>
      <div id="visual" class="list mono">（尚无数据）</div>
      <h3 class="muted" style="margin:14px 0 4px;">未点的按钮</h3>
      <div id="unpicked" class="list mono">（全部已点或尚无数据）</div>
    </section>
  </div>

<script>
/** ====== 配置：九宫格标签 ====== */
const labels = [
  '1','2','3',
  '4','5','6',
  '7','8','9',
  '*','0','#'
];
/** ============================================== */

const btnGrid = document.getElementById('btnGrid');
const visual  = document.getElementById('visual');
const unpicked= document.getElementById('unpicked');
const resetBtn= document.getElementById('resetBtn');
const nextBtn = document.getElementById('nextBtn');

// === 获取或创建输入框元素 ===
const inputBox = document.getElementById('bigNumber') || document.querySelector('#bigNumber');
if (!inputBox) {
  console.warn('未找到 bigNumber 输入框，请确保 HTML 中已有该元素');
}

const counts = Object.fromEntries(labels.map(l => [l, 0]));

function renderButtons() {
  btnGrid.innerHTML = '';
  labels.forEach(label => {
    const btn = document.createElement('button');
    btn.className = 'num';
    btn.textContent = label;

    const badge = document.createElement('span');
    badge.className = 'badge';
    badge.textContent = counts[label];
    if (counts[label] === 0) btn.classList.add('zero');
    btn.appendChild(badge);

    btn.addEventListener('click', () => {
      counts[label] += 1;
      updateUI();
    });
    btnGrid.appendChild(btn);
  });
}

function renderResults() {
  const lines = labels.map(l => {
    const n = counts[l];
    const marks = n > 0 ? '✅'.repeat(n) : '❌';
    return `${l} → ${marks}`;
  });
  visual.textContent = lines.join('\n');

  const none = labels.filter(l => counts[l] === 0);
  unpicked.textContent = none.length ? none.join(', ') : '（无：都被点过了）';
}

function updateUI() {
  Array.from(btnGrid.children).forEach((btn, idx) => {
    const label = labels[idx];
    const badge = btn.querySelector('.badge');
    badge.textContent = counts[label];
    btn.classList.toggle('zero', counts[label] === 0);
  });
  renderResults();
}

// === 清空按钮：重置计数 + 清空三位数字 ===
resetBtn.addEventListener('click', () => {
  // 1. 清空所有按钮计数
  Object.keys(counts).forEach(k => counts[k] = 0);

  // 2. 获取范围输入框
  const r1 = document.getElementById('rangeStart'); // 起始值
  const r2 = document.getElementById('rangeEnd');   // 结束值

  // 3. 设置大数字框为起始值（若为空则置空）
  if (inputBox) {
    const startVal = (r1 && r1.value.trim() !== '') ? r1.value.trim() : '';
    inputBox.value = startVal;
  }

  // 4. 不清空范围输入框，保留用户填写的范围
  updateUI();
});

// === “下一批”：清空计数 + 根据范围循环 ===
nextBtn.addEventListener('click', () => {
  // 清空所有按钮次数
  Object.keys(counts).forEach(k => counts[k] = 0);

  const r1 = document.getElementById('rangeStart');
  const r2 = document.getElementById('rangeEnd');
  let startVal = parseInt(r1?.value || '', 10);
  let endVal   = parseInt(r2?.value || '', 10);
  let current  = parseInt(inputBox?.value || '0', 10);

  // 处理非法或空值
  if (isNaN(current)) current = 0;
  const hasRange = !isNaN(startVal) && !isNaN(endVal);
  const hasStartOnly = !isNaN(startVal) && isNaN(endVal);

  let next;

  if (hasRange) {
    // 范围循环
    if (current < startVal || current > endVal) next = startVal;
    else next = (current + 1 > endVal) ? startVal : current + 1;
  } else if (hasStartOnly) {
    // 只有起始值时，从起始开始递增
    next = (current < startVal) ? startVal : (current + 1) % 1000;
  } else {
    // 都没填：按旧逻辑 +1 循环 000~999
    next = (current + 1) % 1000;
  }

  if (inputBox)
    inputBox.value = next.toString().padStart(3, '0');

  updateUI();
});

renderButtons();
renderResults();
</script>
</body>
</html>
